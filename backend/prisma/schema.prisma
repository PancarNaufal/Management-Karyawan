generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider          = "sqlserver"
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

model Role {
  id               Int      @id @default(autoincrement())
  nama             String   @unique
  deskripsi        String?
  createdAt        DateTime @default(now())
  updatedAt        DateTime @default(now()) @updatedAt
  gajiPokokBulanan Float    @default(0, map: "DF__Role__gajiPokokB__14270015")
  users            User[]
}

model User {
  id               Int                @id @default(autoincrement())
  email            String             @unique
  nama             String
  password         String
  roleId           Int
  absensi          Absensi[]
  jadwal           Jadwal[]
  laporanPemasukan LaporanPemasukan[]
  slipGaji         SlipGaji[]
  role             Role               @relation(fields: [roleId], references: [id])
}

model Jadwal {
  id           Int      @id @default(autoincrement())
  waktuMulai   DateTime
  waktuSelesai DateTime
  userId       Int
  user         User     @relation(fields: [userId], references: [id])
}

model Absensi {
  id        Int       @id @default(autoincrement())
  jamMasuk  DateTime  @default(now())
  jamKeluar DateTime?
  userId    Int
  user      User      @relation(fields: [userId], references: [id])
}

model SlipGaji {
  id              Int      @id(map: "PK__SlipGaji__3213E83F956E160B") @default(autoincrement())
  bulan           Int
  tahun           Int
  gajiBulanan     Float
  bonusKehadiran  Float    @default(0, map: "DF__SlipGaji__bonusK__17F790F9")
  bonusLainnya    Float    @default(0, map: "DF__SlipGaji__bonusL__18EBB532")
  potonganAlpha   Float    @default(0, map: "DF__SlipGaji__potong__19DFD96B")
  potonganTelat   Float    @default(0, map: "DF__SlipGaji__potong__1AD3FDA4")
  potonganLainnya Float    @default(0, map: "DF__SlipGaji__potong__1BC821DD")
  totalGajiKotor  Float
  totalPotongan   Float
  totalGajiBersih Float
  tanggalBayar    DateTime @default(now(), map: "DF__SlipGaji__tangga__1CBC4616") @db.DateTime
  keterangan      String?  @db.NVarChar(500)
  userId          Int
  createdAt       DateTime @default(now(), map: "DF__SlipGaji__create__1EA48E88") @db.DateTime
  updatedAt       DateTime @default(now(), map: "DF__SlipGaji__update__1F98B2C1") @updatedAt @db.DateTime
  user            User     @relation(fields: [userId], references: [id], onUpdate: NoAction, map: "FK__SlipGaji__userId__151B244E")

  @@unique([userId, bulan, tahun])
}

model LaporanPemasukan {
  id              Int      @id @default(autoincrement())
  jumlahPemasukan Float
  tanggalLaporan  DateTime
  shift           String
  userId          Int
  user            User     @relation(fields: [userId], references: [id])
}
